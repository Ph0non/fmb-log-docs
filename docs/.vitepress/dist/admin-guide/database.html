<!DOCTYPE html>
<html lang="de-DE" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Betrieb &amp; Datenbank | FMB Log</title>
    <meta name="description" content="Benutzer- und Administratorhandbuch">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/fmb-log-docs/assets/style.THDtKUiR.css" as="style">
    <link rel="preload stylesheet" href="/fmb-log-docs/vp-icons.css" as="style">
    
    <script type="module" src="/fmb-log-docs/assets/app.Bxf87JDR.js"></script>
    <link rel="preload" href="/fmb-log-docs/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/fmb-log-docs/assets/chunks/theme._8TjO5aB.js">
    <link rel="modulepreload" href="/fmb-log-docs/assets/chunks/framework.B6P7veLL.js">
    <link rel="modulepreload" href="/fmb-log-docs/assets/chunks/sql-schema.QSgS6JlQ.js">
    <link rel="modulepreload" href="/fmb-log-docs/assets/admin-guide_database.md.CDszNfAh.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/fmb-log-docs/" data-v-1168a8e4><!--[--><!--]--><!----><span data-v-1168a8e4>FMB Log</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/fmb-log-docs/user-guide/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>User Guide</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/fmb-log-docs/admin-guide/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Admin Guide</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/fmb-log-docs/reference/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Referenz</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/fmb-log-docs/architecture/" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Architektur</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 has-active" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>Admin Guide</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/fmb-log-docs/admin-guide/" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Überblick</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/fmb-log-docs/admin-guide/setup.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Ersteinrichtung</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/fmb-log-docs/admin-guide/security.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Sicherheitsarchitektur</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/fmb-log-docs/admin-guide/users.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Benutzer</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/fmb-log-docs/admin-guide/groups-permissions.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Gruppen & Rechte</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/fmb-log-docs/admin-guide/fgw.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Freigabewerte (FGW)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/fmb-log-docs/admin-guide/database.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Betrieb & Datenbank</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/fmb-log-docs/admin-guide/technical.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Technische Doku</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/fmb-log-docs/admin-guide/troubleshooting.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Troubleshooting</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _fmb-log-docs_admin-guide_database" data-v-39a288b8><div><h1 id="betrieb-datenbank" tabindex="-1">Betrieb &amp; Datenbank <a class="header-anchor" href="#betrieb-datenbank" aria-label="Permalink to &quot;Betrieb &amp; Datenbank&quot;">​</a></h1><p>FMB Log speichert alle Daten in einer einzelnen SQLite‑Datei. Dadurch ist kein Datenbankserver notwendig und die Anwendung kann auch offline betrieben werden.</p><h2 id="standard‐datenbankpfad" tabindex="-1">Standard‑Datenbankpfad <a class="header-anchor" href="#standard‐datenbankpfad" aria-label="Permalink to &quot;Standard‑Datenbankpfad&quot;">​</a></h2><p>Standardmäßig liegt die Datenbank im Programmordner unter <code>resources/fmblog.db</code>. Beim ersten Start legt die Anwendung das Unterverzeichnis <code>resources</code> an (falls es fehlt) und erstellt die Datenbankdatei beim Öffnen automatisch.</p><p>Dieser Standard ist bewusst gewählt: Die Datenbank ist damit leicht auffindbar, einfach zu sichern und kann (sofern gewünscht) auch auf einen gemeinsam genutzten Pfad gelegt werden.</p><h2 id="stub‐db-und-updates" tabindex="-1">Stub‑DB und Updates <a class="header-anchor" href="#stub‐db-und-updates" aria-label="Permalink to &quot;Stub‑DB und Updates&quot;">​</a></h2><p>Für Neuinstallationen oder Updates kann eine <strong>Stub‑Datenbank</strong> mitgeliefert werden. Beim ersten Start wird dann (falls noch keine Datenbank existiert) <code>resources/fmblog.stub.db</code> aus den gebündelten Ressourcen nach <code>resources/fmblog.db</code> kopiert.</p><p>Wichtig: Eine vorhandene Datenbank wird dabei <strong>niemals überschrieben</strong>. Damit bleiben Bestandsdaten bei Updates erhalten.</p><h2 id="datenmodell-er" tabindex="-1">Datenmodell (ER) <a class="header-anchor" href="#datenmodell-er" aria-label="Permalink to &quot;Datenmodell (ER)&quot;">​</a></h2><p>Eine vereinfachte Darstellung des SQL-Schemas als ER-Diagramm finden Sie hier:</p><p><img src="/fmb-log-docs/assets/sql-schema.CyQ-IefR.svg" alt="SQL-Schema (ER)"></p><h2 id="netzlaufwerk-und-mehrbenutzer" tabindex="-1">Netzlaufwerk und Mehrbenutzer <a class="header-anchor" href="#netzlaufwerk-und-mehrbenutzer" aria-label="Permalink to &quot;Netzlaufwerk und Mehrbenutzer&quot;">​</a></h2><p>SQLite kann grundsätzlich auf Netzlaufwerken funktionieren, allerdings hängt die Stabilität stark von Dateisperren/Locking, SMB‑Konfiguration (z. B. OpLocks) und der Latenz/Zuverlässigkeit des Shares ab. In Mehrbenutzer‑Szenarien kommt es typischerweise nicht auf „viele Leser“, sondern auf <strong>gleichzeitige Schreibzugriffe</strong> an.</p><p>Empfehlung: Validieren Sie den Mehrbenutzerbetrieb zunächst in einer Testumgebung und definieren Sie organisatorisch, wer wann Änderungen schreibt (z. B. Import zentral, Auswertung verteilt). Wenn regelmäßig Sperren oder Zeitüberschreitungen auftreten, ist ein lokaler DB‑Pfad pro Nutzer die robustere Variante.</p><h2 id="synchronisation-hub‐db-und-lokale-replica" tabindex="-1">Synchronisation (Hub‑DB und lokale Replica) <a class="header-anchor" href="#synchronisation-hub‐db-und-lokale-replica" aria-label="Permalink to &quot;Synchronisation (Hub‑DB und lokale Replica)&quot;">​</a></h2><p>Für den Mehrnutzerbetrieb nutzt FMB Log eine <strong>lokale Replica‑DB</strong> (pro Windows‑Benutzer) und synchronisiert diese regelmäßig mit einer <strong>Hub‑DB</strong> (z. B. im gemeinsamen Datenordner / Netzlaufwerk):</p><ul><li><strong>Hub‑DB:</strong> entspricht dem in den Einstellungen gesetzten DB‑Pfad (oder dem Standard unter <code>resources/fmblog.db</code>)</li><li><strong>Lokale Replica:</strong> wird im Benutzerprofil unter <code>AppData/Local/&lt;app-id&gt;/replicas/…</code> angelegt</li><li><strong>Sync:</strong> läuft automatisch (z. B. beim Fokuswechsel und alle ~10 s)</li></ul><h3 id="warum-lokale-replica-crdt" tabindex="-1">Warum lokale Replica + CRDT? <a class="header-anchor" href="#warum-lokale-replica-crdt" aria-label="Permalink to &quot;Warum lokale Replica + CRDT?&quot;">​</a></h3><p>Ein reiner SQLite‑Mehrbenutzerbetrieb über ein Netzlaufwerk ist oft fragil (Dateisperren, OpLocks, Latenz). Die Replica‑Architektur reduziert dieses Risiko deutlich:</p><ul><li><strong>Offline‑fähig:</strong> Die Anwendung bleibt auch bei temporär nicht verfügbarem Hub nutzbar (Arbeit in der lokalen Replica).</li><li><strong>Weniger Lock‑Druck auf dem Share:</strong> Nutzer schreiben hauptsächlich lokal; der Hub wird kurz/periodisch synchronisiert.</li><li><strong>Konfliktbehandlung:</strong> Gleichzeitige Änderungen können deterministisch zusammengeführt werden (CRDT/CR‑SQLite).</li></ul><p><img src="/fmb-log-docs/assets/crdt.CZLDzoJd.svg" alt="Local‑First / CRDT (Übersicht)"></p><h3 id="wie-funktioniert-cr‐sqlite-crr-in-fmb-log" tabindex="-1">Wie funktioniert CR‑SQLite (CRR) in FMB Log? <a class="header-anchor" href="#wie-funktioniert-cr‐sqlite-crr-in-fmb-log" aria-label="Permalink to &quot;Wie funktioniert CR‑SQLite (CRR) in FMB Log?&quot;">​</a></h3><p>FMB Log verwendet CR‑SQLite, um Tabellen als <strong>CRR (Conflict‑free Replicated Relations)</strong> zu betreiben. Vereinfacht:</p><ul><li>Jede DB‑Instanz hat eine eigene <strong>Site‑ID</strong>.</li><li>Änderungen werden von CR‑SQLite als <strong>Change‑Events</strong> erfasst (<code>crsql_changes</code>).</li><li>Beim Sync werden neue Change‑Events zwischen lokaler Replica und Hub ausgetauscht und angewendet.</li></ul><p>Wichtig: Das Ergebnis ist <strong>eventual consistency</strong>. Nach erfolgreichem Sync konvergieren alle Replicas (deterministisch) auf denselben Zustand – ohne dass die Anwendung dazu File‑Locks “manuell” koordinieren muss.</p><p><img src="/fmb-log-docs/assets/cr-sqlite-arch.7ou62ngN.svg" alt="cr‑sqlite Architektur"></p><h3 id="sync‐ablauf-automatisch" tabindex="-1">Sync‑Ablauf (automatisch) <a class="header-anchor" href="#sync‐ablauf-automatisch" aria-label="Permalink to &quot;Sync‑Ablauf (automatisch)&quot;">​</a></h3><p>Der Sync läuft automatisch und “best effort”:</p><ul><li>Beim Start wird ein initialer Sync versucht.</li><li>Zusätzlich bei Fokuswechsel (zurück zur App) und periodisch alle ~10 s.</li><li>Technisch werden erst <strong>Änderungen aus dem Hub in die lokale Replica gezogen</strong> (Pull) und danach <strong>lokale Änderungen in den Hub geschrieben</strong> (Push).</li></ul><p><img src="/fmb-log-docs/assets/sync-db.Ail9lVWT.svg" alt="Sync‑Prozess"></p><h3 id="einschrankungen-wichtig" tabindex="-1">Einschränkungen (wichtig) <a class="header-anchor" href="#einschrankungen-wichtig" aria-label="Permalink to &quot;Einschränkungen (wichtig)&quot;">​</a></h3><p>Auch mit CRDT/CR‑SQLite gibt es Grenzen und “Betriebsregeln”:</p><ol><li><p><strong>Konflikte sind möglich (und werden aufgelöst)</strong><br> Wenn zwei Nutzer <em>dieselbe</em> Entität gleichzeitig bearbeiten, greift eine deterministische Merge‑Regel. In der Praxis bedeutet das oft “Last‑Write‑Wins” auf Feld‑/Zellenebene.<br> Empfehlung: Kritische Stammdaten (FGW/NV/FMK) organisatorisch nur durch wenige Key‑User ändern lassen.</p></li><li><p><strong>Schema‑Constraints für CRR‑Tabellen</strong><br> CR‑SQLite stellt Anforderungen an das Schema (u. a. nicht‑nullable Primary Keys; keine <code>NOT NULL</code>‑Spalten ohne Default‑Wert).<br> Daraus folgt: IDs sind in FMB Log als <strong>stabile, eindeutige TEXT‑IDs</strong> ausgelegt (statt Auto‑Increment), und Schema‑Änderungen erfolgen über App‑Migrations.</p></li><li><p><strong>Netzwerk‑/Share‑Qualität bleibt entscheidend</strong><br> Der Hub ist weiterhin eine SQLite‑Datei. Wenn das Share instabil ist (Locking, hohe Latenz), kann es trotz Replica‑Ansatz zu Sync‑Fehlern kommen. Die App bleibt dann lokal nutzbar, aber Änderungen können erst später verteilt werden.</p></li><li><p><strong>Große BLOBs kosten Sync‑Zeit</strong><br> Messprotokolle werden bewusst <strong>nicht</strong> als BLOB in der CRDT‑SQLite synchronisiert. Stattdessen werden sie zstd‑komprimiert in einem Protokoll‑Archiv <strong>neben der Hub‑DB</strong> gespeichert und in der DB nur referenziert (BLAKE3, Archivdatei, Offset/Länge, optional <code>dict_id</code>).<br> Ergebnis: Der CR‑SQLite‑Sync bleibt schnell, weil er nur Metadaten synchronisiert.</p><p><strong>Ablage im Hub‑Ordner (neben <code>&lt;db&gt;.db</code>)</strong>:</p><ul><li><code>protocols/&lt;site-id-hex&gt;/pack-*.bin</code> (Packfiles, append‑only; max. ~100 Einträge oder ~1 MB pro Pack)</li><li><code>protocols/&lt;site-id-hex&gt;/state.json</code> (merkt sich das aktuelle Packfile)</li><li>DB‑Referenzen in <code>measurement_protocols</code> (<code>pack_file</code>, <code>pack_offset</code>, <code>pack_length</code>, <code>blake3</code>, <code>dict_id</code>, …)</li><li>Hinweis: Die Spalte <code>sha256</code> existiert nur für Abwärtskompatibilität und ist für neue Imports i. d. R. leer (maßgeblich ist <code>blake3</code>).</li></ul><p><strong>Offline‑Import:</strong> Wenn der Hub nicht erreichbar ist, wird das Protokoll im <strong>lokalen Cache</strong> abgelegt und die DB enthält zunächst eine „ausstehende“ Referenz (<code>pack_file=&#39;&#39;</code>, <code>pack_length=0</code>). Zusätzlich wird lokal eine Outbox geführt (<code>protocol_upload_outbox</code>), die Upload‑Versuche, Backoff und Fehlerstatus verwaltet (Status ist auf der Import‑Seite in „Ausstehende Uploads“ sichtbar). Nach dem nächsten erfolgreichen Sync lädt der importierende Client das Protokoll automatisch in das Hub‑Archiv hoch und aktualisiert die Referenz. Bis dahin können andere Clients die Messung sehen, das Protokoll aber noch nicht öffnen.</p></li></ol><h3 id="besonderheit-vault‐dateien-sind-nicht-teil-der-db‐synchronisation" tabindex="-1">Besonderheit: Vault‑Dateien sind nicht Teil der DB‑Synchronisation <a class="header-anchor" href="#besonderheit-vault‐dateien-sind-nicht-teil-der-db‐synchronisation" aria-label="Permalink to &quot;Besonderheit: Vault‑Dateien sind nicht Teil der DB‑Synchronisation&quot;">​</a></h3><p>Passwörter und Signierschlüssel werden zusätzlich in <strong>Stronghold‑Vaults</strong> gespeichert:</p><ul><li>Nutzer‑Vaults: <code>vaults/&lt;user_id&gt;.vault</code></li><li>Integritäts‑Vault: <code>vaults/&lt;db&gt;.integrity.vault</code></li></ul><p>Diese Dateien liegen <strong>neben der Hub‑DB</strong> im gemeinsamen Datenordner und werden <strong>nicht</strong> über die DB‑Synchronisation repliziert. Daher gilt:</p><ul><li>Kritische Admin‑Operationen (Benutzer-/Gruppen-/Rechteverwaltung, Integritätsschlüssel) sollten nur durchgeführt werden, wenn der Hub‑Pfad erreichbar ist.</li><li>Wenn der Hub‑Pfad nicht erreichbar ist, sind diese Aktionen in der UI deaktiviert (die Fach‑/Messdaten können weiterhin über die lokale Replica bearbeitet werden).</li></ul><h2 id="backup" tabindex="-1">Backup <a class="header-anchor" href="#backup" aria-label="Permalink to &quot;Backup&quot;">​</a></h2><p>Die sicherste Backup‑Strategie ist, die relevanten Dateien zu kopieren, wenn die Anwendung geschlossen ist. Für den Betrieb empfiehlt sich eine regelmäßige Sicherung (z. B. täglich) und eine Aufbewahrung mehrerer Generationen (Rotation), damit auch ältere Tagesabrechnungen nachvollziehbar bleiben.</p><p>Sichern Sie im Hub‑Ordner mindestens:</p><ul><li>die DB‑Datei (<code>&lt;db&gt;.db</code> bzw. <code>fmblog.db</code>)</li><li>den Ordner <code>protocols/</code> (Protokoll‑Archive/Packfiles)</li><li>den Ordner <code>vaults/</code> (Stronghold‑Vaults für Pepper/Integritätsschlüssel)</li></ul><div class="info custom-block"><p class="custom-block-title">Zusammenfassung (Datenbank)</p><ul><li>Eine Datei: SQLite <code>resources/fmblog.db</code> (Standardpfad).</li><li>Optional: Stub‑DB <code>resources/fmblog.stub.db</code> wird nur kopiert, wenn noch keine DB existiert.</li><li>Netzlaufwerke sind möglich, aber lock-/latency‑abhängig → vorher testen.</li><li>Mehrnutzerbetrieb: lokale Replica + CR‑SQLite Sync (eventual consistency).</li><li>Protokolle liegen als Packfiles im Hub‑Ordner (<code>protocols/…</code>), nicht als BLOB in der DB.</li><li>Backups am besten bei geschlossener Anwendung.</li></ul></div></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><div class="edit-info" data-v-e257564d><!----><div class="last-updated" data-v-e257564d><p class="VPLastUpdated" data-v-e257564d data-v-e98dd255>Last updated: <time datetime="2026-01-12T10:31:53.000Z" data-v-e98dd255></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/fmb-log-docs/admin-guide/fgw.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>Freigabewerte (FGW)</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/fmb-log-docs/admin-guide/technical.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>Technische Doku</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-5d98c3a5 data-v-e315a0ad><div class="container" data-v-e315a0ad><p class="message" data-v-e315a0ad>FMB Log – Dokumentation</p><p class="copyright" data-v-e315a0ad>©EWN GmbH 2025, Martin Klemann</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"admin-guide_database.md\":\"CDszNfAh\",\"admin-guide_fgw.md\":\"DyAqJnev\",\"admin-guide_groups-permissions.md\":\"Bb9is761\",\"admin-guide_index.md\":\"X92vU7GB\",\"admin-guide_security.md\":\"DB_QJzs0\",\"admin-guide_setup.md\":\"B1Ot99qR\",\"admin-guide_technical.md\":\"C5EIBDjt\",\"admin-guide_troubleshooting.md\":\"Bg8ouBKV\",\"admin-guide_users-permissions.md\":\"DFS-9MhT\",\"admin-guide_users.md\":\"DKQ-Ov4y\",\"architecture_adr-001-crsqlite.md\":\"B0xU-iHp\",\"architecture_adr-002-integrity-signing.md\":\"EYWcJvpu\",\"architecture_adr-003-protocol-packs.md\":\"D-XhCq5F\",\"architecture_index.md\":\"Clw8WLP5\",\"index.md\":\"CemxtM5x\",\"reference_data-model.md\":\"vPjmTbNR\",\"reference_formulas.md\":\"BxSNdp1p\",\"reference_index.md\":\"DOxQGOtF\",\"reference_permissions.md\":\"_30KZLsz\",\"user-guide_account.md\":\"BCv0ODpT\",\"user-guide_containers.md\":\"DyYn7qn_\",\"user-guide_data-quality.md\":\"D1AWnYNw\",\"user-guide_fmk.md\":\"x6bEOd01\",\"user-guide_glossary.md\":\"B69lAy7Z\",\"user-guide_import.md\":\"Bbwcj778\",\"user-guide_index.md\":\"vqXMrjco\",\"user-guide_nuclide-vectors.md\":\"DFNblQgx\",\"user-guide_quickstart.md\":\"b8rZUbaE\",\"user-guide_reports.md\":\"DdMe0HWT\",\"user-guide_search.md\":\"DKFVhDZM\",\"user-guide_settings.md\":\"C7nWYNqO\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"de-DE\",\"dir\":\"ltr\",\"title\":\"FMB Log\",\"description\":\"Benutzer- und Administratorhandbuch\",\"base\":\"/fmb-log-docs/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"User Guide\",\"link\":\"/user-guide/\"},{\"text\":\"Admin Guide\",\"link\":\"/admin-guide/\"},{\"text\":\"Referenz\",\"link\":\"/reference/\"},{\"text\":\"Architektur\",\"link\":\"/architecture/\"}],\"sidebar\":{\"/user-guide/\":[{\"text\":\"User Guide\",\"items\":[{\"text\":\"Überblick\",\"link\":\"/user-guide/\"},{\"text\":\"Schnellstart\",\"link\":\"/user-guide/quickstart\"},{\"text\":\"Suche & Deep-Links\",\"link\":\"/user-guide/search\"},{\"text\":\"Datenqualität\",\"link\":\"/user-guide/data-quality\"},{\"text\":\"Gebinde & Messungen\",\"link\":\"/user-guide/containers\"},{\"text\":\"Import (RPT / GS)\",\"link\":\"/user-guide/import\"},{\"text\":\"Nuklidvektoren (NV)\",\"link\":\"/user-guide/nuclide-vectors\"},{\"text\":\"FMK\",\"link\":\"/user-guide/fmk\"},{\"text\":\"Tagesabrechnung\",\"link\":\"/user-guide/reports\"},{\"text\":\"Einstellungen\",\"link\":\"/user-guide/settings\"},{\"text\":\"Konto & Passwort\",\"link\":\"/user-guide/account\"},{\"text\":\"Glossar\",\"link\":\"/user-guide/glossary\"}]}],\"/admin-guide/\":[{\"text\":\"Admin Guide\",\"items\":[{\"text\":\"Überblick\",\"link\":\"/admin-guide/\"},{\"text\":\"Ersteinrichtung\",\"link\":\"/admin-guide/setup\"},{\"text\":\"Sicherheitsarchitektur\",\"link\":\"/admin-guide/security\"},{\"text\":\"Benutzer\",\"link\":\"/admin-guide/users\"},{\"text\":\"Gruppen & Rechte\",\"link\":\"/admin-guide/groups-permissions\"},{\"text\":\"Freigabewerte (FGW)\",\"link\":\"/admin-guide/fgw\"},{\"text\":\"Betrieb & Datenbank\",\"link\":\"/admin-guide/database\"},{\"text\":\"Technische Doku\",\"link\":\"/admin-guide/technical\"},{\"text\":\"Troubleshooting\",\"link\":\"/admin-guide/troubleshooting\"}]}],\"/reference/\":[{\"text\":\"Referenz\",\"items\":[{\"text\":\"Überblick\",\"link\":\"/reference/\"},{\"text\":\"Rechte (Permission Keys)\",\"link\":\"/reference/permissions\"},{\"text\":\"Datenmodell\",\"link\":\"/reference/data-model\"},{\"text\":\"Rechner & Formeln\",\"link\":\"/reference/formulas\"}]}],\"/architecture/\":[{\"text\":\"Architektur\",\"items\":[{\"text\":\"Überblick\",\"link\":\"/architecture/\"},{\"text\":\"ADR‑001: CR‑SQLite\",\"link\":\"/architecture/adr-001-crsqlite\"},{\"text\":\"ADR‑002: Integrität & Signaturen\",\"link\":\"/architecture/adr-002-integrity-signing\"},{\"text\":\"ADR‑003: Protokoll‑Packfiles\",\"link\":\"/architecture/adr-003-protocol-packs\"}]}]},\"search\":{\"provider\":\"local\"},\"footer\":{\"message\":\"FMB Log – Dokumentation\",\"copyright\":\"©EWN GmbH 2025, Martin Klemann\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>